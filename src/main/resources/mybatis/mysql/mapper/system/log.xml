<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="log">

	<!--日志插入 -->
	<insert id="insert" parameterType="map" >
		INSERT INTO ${schema.plat}.sys_oper_log
		(
			<!-- OPER_ID, -->
	        USER_ID,
	        TITLE,
	        BUSINESS_TYPE,
	        METHOD,
	        REQUEST_METHOD,
	        OPERATOR_TYPE,
	        OPER_NAME,
	        DEPT_NAME,
	        OPER_URL,
	        OPER_IP,
	        OPER_LOCATION,
	        OPER_PARAM,
	        JSON_RESULT,
	        STATUS,
	        ERROR_MSG,
	        OPER_TIME
		)
		VALUES 
		(
			<!-- #{OPER_ID,jdbcType=VARCHAR}, -->
	        #{USER_ID,jdbcType=VARCHAR},
	        #{TITLE,jdbcType=VARCHAR},
	        #{BUSINESS_TYPE,jdbcType=VARCHAR},
	        #{METHOD,jdbcType=VARCHAR},
	        #{REQUEST_METHOD,jdbcType=VARCHAR},
	        #{OPERATOR_TYPE,jdbcType=VARCHAR},
	        #{OPER_NAME,jdbcType=VARCHAR},
	        #{DEPT_NAME,jdbcType=VARCHAR},
	        #{OPER_URL,jdbcType=VARCHAR},
	        #{OPER_IP,jdbcType=VARCHAR},
	        #{OPER_LOCATION,jdbcType=VARCHAR},
	        #{OPER_PARAM,jdbcType=VARCHAR},
	        #{JSON_RESULT,jdbcType=VARCHAR},
	        #{STATUS,jdbcType=VARCHAR},
	        #{ERROR_MSG,jdbcType=VARCHAR},
	        DATE_FORMAT(NOW(), "%Y-%m-%d %H:%i:%s")
		)
	</insert>

	<!--日志分页查询-->
	<select id="logList" parameterType="map" resultType="java.util.HashMap">
		SELECT  OPER_ID,
		USER_ID,
		TITLE,
		BUSINESS_TYPE,
		METHOD,
		REQUEST_METHOD,
		OPERATOR_TYPE,
		OPER_NAME,
		DEPT_NAME,
		OPER_URL,
		OPER_IP,
		OPER_LOCATION,
		OPER_PARAM,
		JSON_RESULT,
		STATUS LOG_STATUS,
		ERROR_MSG,
		OPER_TIME
		FROM
		${schema.plat}.sys_oper_log sol
		<where>
			<if test="TITLE !=null and TITLE != ''">
				AND sol.TITLE LIKE CONCAT('%',#{TITLE},'%')
			</if>
			<if test="OPER_NAME !=null and OPER_NAME != ''">
				AND sol.OPER_NAME LIKE CONCAT('%',#{OPER_NAME},'%')
			</if>
			<if test="BUSINESS_TYPE !=null and BUSINESS_TYPE != ''">
				AND sol.BUSINESS_TYPE = #{BUSINESS_TYPE}
			</if>
			<if test="STATUS !=null and STATUS != ''">
				AND sol.STATUS = #{STATUS}
			</if>
		</where>
	</select>

	<!--日志详情查询-->
	<select id="logLoad" parameterType="map" resultType="java.util.HashMap">
		SELECT  OPER_ID,
		USER_ID,
		TITLE,
		 BUSINESS_TYPE,
		METHOD,
		REQUEST_METHOD,
		OPERATOR_TYPE,
		OPER_NAME,
		DEPT_NAME,
		OPER_URL,
		OPER_IP,
		OPER_LOCATION,
		OPER_PARAM,
		JSON_RESULT,
		STATUS,
		ERROR_MSG,
		OPER_TIME
		FROM
		${schema.plat}.sys_oper_log sol
		<where>
			 OPER_ID=#{OPER_ID}
		</where>
	</select>
	
</mapper>